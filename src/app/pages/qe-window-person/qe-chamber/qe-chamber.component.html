<div fxLayoutAlign="center stretch" fxLayout="row wrap" class="overflow">
    <div *ngIf="form" fxFlex="80" fxLayoutAlign="center stretch" fxLayout="row wrap" class="box-body mtb-4">
        <app-step1 fxFlex="100" [step1]="form.step1"></app-step1>
        <app-step2 fxFlex="100" [step2]="form.step2"></app-step2>
        <app-step4 fxFlex="100" [step4]="form.step4"></app-step4>

        <mat-divider fxFlex="100" style="margin: 20px 0;"></mat-divider>

        <app-qe-chamber-planning fxFlex="100" [data]="dataSource" (dataChange)="foo($event)"></app-qe-chamber-planning>

        <div fxFlex="100" fxLayoutAlign="space-around stretch" fxLayout="row wrap" *ngFor="let item of chamberTable; let i=index" class="box-body mtb-4">
            <h3 *ngIf="item.condition" fxFlex="100">
                {{i+1}}. {{item.condition.name}}
            </h3>

            <label fxFlex="100">
        {{i+1}}.1 CHAMBER DETAIL
      </label>

            <mat-form-field fxFlex.gt-lg="45" fxFlex.sm="100" *ngIf="item.condition" appearance="legacy">
                <mat-label>Condition Name</mat-label>
                <input matInput [(ngModel)]="item.condition.name" [readonly]="true">
            </mat-form-field>

            <mat-form-field fxFlex.gt-lg="45" fxFlex.sm="100" *ngIf="item.work" appearance="legacy">
                <mat-label>Qty</mat-label>
                <input matInput [(ngModel)]="item.work.qty" [readonly]="true">
            </mat-form-field>

            <mat-form-field fxFlex.gt-lg="45" fxFlex.sm="100" appearance="fill">
                <mat-label>START DATE</mat-label>
                <input matInput [readonly]="true" [matDatepicker]="startDate" [(ngModel)]="item.startDate" (ngModelChange)="onCal(item,i)">
                <mat-datepicker-toggle matSuffix [for]="startDate"></mat-datepicker-toggle>
                <mat-datepicker touchUi #startDate></mat-datepicker>
            </mat-form-field>

            <mat-form-field fxFlex.gt-lg="45" fxFlex.sm="100" appearance="fill">
                <mat-label>TIME</mat-label>
                <mat-select (selectionChange)="onSelectHour(item,$event)">
                    <mat-option *ngFor="let h of hourList; let i=index" [value]="h">{{h}}</mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field fxFlex.gt-lg="45" fxFlex.sm="100" appearance="fill" *ngFor="let time of item.inspectionTime; let indexTime=index">
                <mat-label>TIME AT {{time.at}} (hr)</mat-label>
                <input matInput type="number" [(ngModel)]="time.hr" (ngModelChange)="onCal(item,i)">
            </mat-form-field>

            <mat-form-field fxFlex.gt-lg="45" fxFlex.sm="100" appearance="legacy">
                <mat-label>END DATE</mat-label>
                <input matInput [value]="item.endDate|date:'EEEE, d MMMM y, h:mm a'" [readonly]="true">
            </mat-form-field>

            <div fxFlex.gt-lg="45"></div>


            <mat-divider fxFlex="100" class="mtb-4"></mat-divider>

            <div fxFlex="100" fxLayoutAlign="space-between stretch" fxLayout="row wrap">
                <label>
          {{i+1}}.2 CHAMBER SELECT
        </label>
                <button mat-raised-button color="primary" (click)="dialogChamber(item)">CHAMBER</button>
            </div>

            <mat-form-field fxFlex.gt-lg="45" fxFlex.sm="100" *ngIf="item.chamber" appearance="legacy">
                <mat-label>CHAMBER CODE</mat-label>
                <input matInput [(ngModel)]="item.chamber.code" [readonly]="true">
            </mat-form-field>


            <mat-form-field fxFlex.gt-lg="45" fxFlex.sm="100" *ngIf="item.chamber" appearance="legacy">
                <mat-label>CHAMBER NAME</mat-label>
                <input matInput [(ngModel)]="item.chamber.name" [readonly]="true">
            </mat-form-field>

            <mat-divider fxFlex="100" class="mtb-4"></mat-divider>



            <div fxFlex="100" fxLayoutAlign="space-between stretch" fxLayout="row wrap">
                <label>
          {{i+1}}.3 OPERATE SELECT
        </label>
                <button mat-raised-button color="primary" (click)="dialogOperate(item)">OPERATE</button>
            </div>
            <div *ngIf="item.operate && item.operate.checker" fxFlex="30" fxLayoutAlign="start stretch" fxLayout="row wrap">

                <p>CHECKER</p>

                <mat-form-field fxFlex="100" appearance="fill">
                    <mat-label>SELECT</mat-label>
                    <mat-select [compareWith]="compareSelect" (selectionChange)="onSelectChecker($event,item.operate)">
                        <mat-option *ngFor="let it of showOperateItemChecker(operateItems); let i=index" [value]="it">
                            {{it.name}} ({{it.code|uppercase}}), ({{it.stock}} pcs.)
                        </mat-option>
                    </mat-select>
                    <mat-hint class="red">for custom preset</mat-hint>
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="legacy">
                    <mat-label>CODE</mat-label>
                    <input matInput [(ngModel)]="item.operate.checker.code" [readonly]="true" style="text-transform: uppercase;">
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="legacy">
                    <mat-label>CHECKER NAME</mat-label>
                    <input matInput [(ngModel)]="item.operate.checker.name" [readonly]="true">
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="fill">
                    <mat-label>CHECKER QTY</mat-label>
                    <input matInput [(ngModel)]="item.operate.checker.qty">
                </mat-form-field>

            </div>

            <div *ngIf="item.operate && item.operate.power" fxFlex="30" fxLayoutAlign="start stretch" fxLayout="row wrap">

                <p>POWER</p>

                <mat-form-field fxFlex="100" appearance="fill">
                    <mat-label>SELECT</mat-label>
                    <mat-select [compareWith]="compareSelect" (selectionChange)="onSelectPower($event,item.operate)">
                        <mat-option *ngFor="let it of showOperateItemPower(operateItems); let i=index" [value]="it">
                            {{it.name}} ({{it.code|uppercase}}), ({{it.stock}} pcs.)
                        </mat-option>
                    </mat-select>
                    <mat-hint class="red">for custom preset</mat-hint>
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="legacy">
                    <mat-label>CODE</mat-label>
                    <input matInput [(ngModel)]="item.operate.power.code" [readonly]="true" style="text-transform: uppercase;">
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="legacy">
                    <mat-label>CHECKER NAME</mat-label>
                    <input matInput [(ngModel)]="item.operate.power.name" [readonly]="true">
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="fill">
                    <mat-label>CHECKER QTY</mat-label>
                    <input matInput [(ngModel)]="item.operate.power.qty">
                </mat-form-field>

            </div>

            <div *ngIf="item.operate && item.operate.attachment" fxFlex="30" fxLayoutAlign="start stretch" fxLayout="row wrap">

                <p>ATTACHMENT</p>

                <mat-form-field fxFlex="100" appearance="fill">
                    <mat-label>SELECT</mat-label>
                    <mat-select [compareWith]="compareSelect" (selectionChange)="onSelectAttachment($event,item.operate)">
                        <mat-option *ngFor="let it of showOperateItemAttachment(operateItems); let i=index" [value]="it">
                            {{it.name}} ({{it.code|uppercase}}), ({{it.stock}} pcs.)
                        </mat-option>
                    </mat-select>
                    <mat-hint class="red">for custom preset</mat-hint>
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="legacy">
                    <mat-label>CODE</mat-label>
                    <input matInput [(ngModel)]="item.operate.attachment.code" [readonly]="true" style="text-transform: uppercase;">
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="legacy">
                    <mat-label>CHECKER NAME</mat-label>
                    <input matInput [(ngModel)]="item.operate.attachment.name" [readonly]="true">
                </mat-form-field>

                <mat-form-field fxFlex="100" appearance="fill">
                    <mat-label>CHECKER QTY</mat-label>
                    <input matInput [(ngModel)]="item.operate.attachment.qty">
                </mat-form-field>

            </div>



        </div>
    </div>

</div>